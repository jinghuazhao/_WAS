<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Pharmacogenomics - software notes</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Pharmacogenomics";
    var mkdocs_page_input_path = "pharmacogenomics.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> software notes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="" href="../index.md">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../AA/">Association</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../AI/">AI</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../CRISPR/">CRISPR</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../NGS/">NGS</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../SL/">SL</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../misc/">misc</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Pharmacogenomics</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../scRNASeq/">scRNASeq</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../prottrans/">prottrans</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">software notes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Pharmacogenomics</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="pythonchembl_webresource_client">Python/chembl_webresource_client</h3>
<p>Web: https://github.com/chembl/chembl_webresource_client</p>
<pre><code class="language-bash">pip install chembl_webresource_client
</code></pre>
<p>UniProtID mapping API: https://www.uniprot.org/help/api_idmapping</p>
<pre><code class="language-python3">import urllib.parse
import urllib.request

url = 'https://www.uniprot.org/uploadlists/'

params = {
'from': 'ACC+ID',
'to': 'CHEMBL_ID',
'format': 'tab',
'query': 'P40925 P40926 O43175 Q9UM73 P97793'
}

data = urllib.parse.urlencode(params)
data = data.encode('utf-8')
req = urllib.request.Request(url, data)
with urllib.request.urlopen(req) as f:
   response = f.read()
print(response.decode('utf-8'))
</code></pre>
<h3 id="rpi">R/Pi</h3>
<pre><code class="language-r">devtools::install_bioc(&quot;Pi&quot;,build_vignettes = TRUE)
library(Pi)
browseVignettes(&quot;Pi&quot;)
</code></pre>
<p>Note that <code>S4Vectors</code> may conflict with the R-devel configurations.</p>
<p>The figshare database as described in the paper can be examined as follows,</p>
<pre><code class="language-bash">gunzip pi_database.sql.gz
mysql -p -u $USER -e &quot;create database pi;&quot;
mysql -p -u $USER pi &lt; pi_database.sql
mysql -p -u $USER pi &lt;&lt;END
show tables;
desc pi_priority;
desc pi_trait;
desc pi_genomic;
desc pi_drug;
desc pi_category;
desc pi_domain;
desc pi_pdb;
select * from pi_priority where trait='RA' and rank&lt;=150 order by rank;
select * from pi_priority where trait='RA' and crosstalk_node='Y' order by rank;
END
</code></pre>
<p>It is relatively easier to convert these as an <a href="../files/pi_database.rda">R object</a>,</p>
<pre><code class="language-r">library(RMySQL)
user &lt;- &quot;my user name&quot;
password &lt;- &quot;mypassword&quot;
mydb = dbConnect(MySQL(), user=user, password=password, dbname='pi')
tbllist &lt;- dbListTables(mydb)
pi_category &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_category;&quot;))
pi_domain &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_domain;&quot;))
pi_drug &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_drug;&quot;))
pi_genomic &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_genomic;&quot;))
pi_pdb &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_pdb;&quot;))
pi_priority &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_priority;&quot;))
pi_trait &lt;- dbGetQuery(mydb, paste0(&quot;select * from pi_trait;&quot;))
# target category
head(pi_category)
# target superfamily druggable
head(pi_domain)
# target uniprot pdb_chain pdb chain pocket
head(pi_pdb)
# trait target rank rating nGene cGene eGene seed fGene pGene dGene gwas crosstalk_node num_neighbor approved phased druggable_category druggable_domain num_pdb num_pdb_with_druggable_pocket magnitude direction description
head(pi_priority)
traits &lt;- c(&quot;AS&quot;,&quot;CRO&quot;,&quot;IGE&quot;,&quot;MS&quot;,&quot;RA&quot;,&quot;T1D&quot;,&quot;UC&quot;)
# trait target max_phase drug mechanism_of_action action_type source
subset(pi_drug,trait%in%traits)
# trait target type name snp snp_type pvalue
subset(pi_genomic,trait%in%traits)
save(pi_category,pi_domain,pi_drug,pi_genomic,pi_pdb,pi_priority,pi_trait,file=&quot;pi_database.rda&quot;)
</code></pre>
<h3 id="rdbparser">R/dbparser</h3>
<p>https://cran.r-project.org/web/packages/dbparser/</p>
<h3 id="rrdgidb">R/rDGIdb</h3>
<p>https://www.bioconductor.org/packages/release/bioc/html/rDGIdb.html</p>
<p>http://www.dgidb.org/</p>
<h3 id="rsunburstr">R/sunburstR</h3>
<p>https://github.com/timelyportfolio/sunburstR</p>
<p>Techinical aspect: https://stackoverflow.com/questions/12926779/how-to-make-a-sunburst-plot-in-r-or-python</p>
<p>Example: https://bl.ocks.org/kerryrodden/7090426</p>
<h2 id="reference">Reference</h2>
<p>Cotto KC, Wagner AH, Feng YY, Kiwala S, Coffman AC, Spies G, Wollam A, Spies NC, Griffith OL, Griffith M. DGIdb 3.0: a redesign and expansion of the drug-gene interaction database. <em>Nucleic Acids Res.</em> 2018 Jan 4;46(D1):D1068-D1073. doi: 10.1093/nar/gkx1143. PMID: 29156001; PMCID: PMC5888642.</p>
<p>Fang H; ULTRA-DD Consortium, De Wolf H, Knezevic B, Burnham KL, Osgood J, Sanniti A, Lledó Lara A, Kasela S, De Cesco S, Wegner JK, Handunnetthi L, McCann FE, Chen L, Sekine T, Brennan PE, Marsden BD, Damerell D, O'Callaghan CA, Bountra C, Bowness P, Sundström Y, Milani L, Berg L, Göhlmann HW, Peeters PJ, Fairfax BP, Sundström M, Knight JC.
A genetics-led approach defines the drug target landscape of 30 immune-related traits.
<em>Nat Genet</em>. 2019 Jul;51(7):1082-1091. doi: 10.1038/s41588-019-0456-1. Epub 2019 Jun 28.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../scRNASeq/" class="btn btn-neutral float-right" title="scRNASeq">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../misc/" class="btn btn-neutral" title="misc"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../misc/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../scRNASeq/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
